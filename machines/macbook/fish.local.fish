# ============================================================================
# Machine-Specific Fish Configuration: MacBook Pro M3 Max
# Computer Name: 9dw-main01-m3max-macbookpro (hostname: Mac)
# Generated by: Trinitas System (Artemis Optimization)
# Date: 2025-11-13, Updated: 2025-11-17
# Purpose: MacBook Pro specific settings and personal functions
# ============================================================================

# ============================================================================
# macOS Build Dependencies
# ============================================================================
set -gx LDFLAGS "-L/opt/homebrew/opt/libxml2/lib"
set -gx CPPFLAGS "-I/opt/homebrew/opt/libxml2/include"
set -gx TESSDATA_PREFIX "/opt/homebrew/share/tessdata/"

# ============================================================================
# Homebrew Environment (Apple Silicon)
# ============================================================================
set -gx HOMEBREW_PREFIX "/opt/homebrew"
set -gx HOMEBREW_CELLAR "/opt/homebrew/Cellar"
set -gx HOMEBREW_REPOSITORY "/opt/homebrew"

# Homebrew PATH (managed by fish_add_path in main config)
# set -gx PATH "/opt/homebrew/bin" "/opt/homebrew/sbin" $PATH

# Homebrew manpages
set -q MANPATH; or set MANPATH ''
set -gx MANPATH "/opt/homebrew/share/man" $MANPATH

# Homebrew info pages
set -q INFOPATH; or set INFOPATH ''
set -gx INFOPATH "/opt/homebrew/share/info" $INFOPATH

# ============================================================================
# macOS-Specific Aliases
# ============================================================================
# Tailscale CLI
alias tailscale "/Applications/Tailscale.app/Contents/MacOS/Tailscale"

# exa (modern ls replacement)
if type -q exa
    alias ll "exa -l -g --icons"
    alias lla "ll -a"
end

# ============================================================================
# Personal Functions
# ============================================================================

# Multi-host file transfer function
# Usage: transfer_files [-o] <source> <destination>
#   -o: Use "outside" network (default: "inside")
function transfer_files
    # Parse options
    set mode "inside"
    while test (count $argv) -gt 0
        switch $argv[1]
            case '-o'
                set mode "outside"
                set argv (echo $argv[2..-1])
            case '*'
                break
        end
    end

    # Validate arguments
    if test (count $argv) -lt 2
        echo "Usage: transfer_files [-o] <source> <destination>" >&2
        echo "  -o: Use outside network (default: inside)" >&2
        return 1
    end

    # Transfer parameters
    set source_path $argv[1]
    set destination_dir $argv[2]

    # Host list (personal network)
    set hosts \
        "9dw-main02-m2ultra-macpro-inside" \
        "9dw-macbook-promax-m2-inside" \
        "9dw-llm-dev01-inside" \
        "9dw-llm-dev02-inside" \
        "9dw-llm-dev03-inside"

    # Transfer to each host
    for host in $hosts
        set remote_host (string replace -r 'inside' $mode $host)
        echo "ðŸ“¤ Transferring $source_path to $remote_host:$destination_dir"
        scp -r $source_path $remote_host:$destination_dir

        if test $status -eq 0
            echo "  âœ… Success: $remote_host"
        else
            echo "  âŒ Failed: $remote_host" >&2
        end
    end

    echo "âœ“ Transfer complete."
end
